### Programs
ChainNucmer/ - Contains the chaining algorithm and evaluate the order of contigs.
IntervalVerify/ - Read in a SAM file sorted by the readid, compute which positions is covered by a mate pair with specified insert size.
Tools/	- Many small scripts
Tools/LocateMisContig.pl - Read in a SAM file sorted by the readid generated by "bwa mem", compute the coordinates and the count for each break point within a read.

### Compile
The C/C++ programs in ChainNucmer/ChainNucmer.cpp and IntervalVerify/IntervalVerify.cpp can be compiled by simply calling g++.

### Usage:
ChainNucmer: (ChainNucmer/reformat.pl, ChainNumcer/ChainNumcer.cpp)
	Suppose we want to chain the local alignment from genome A to genome B. 
	1. Run nucmer, where A is the query, B is the reference.
	2. Generate the default coords file using show-coords, and the first lines are the headers. Suppose the file is nucmer_B_A.coords
	3. Run "reformat.pl A.oneline.fa nucmer_B_A.coords > nucmer_B_A.fragments" to generate the fragment file
	4. ChainNucmer:
		./a.out [-showChain | -overlap xxx | distance ddd] < nucmer_B_A.fragments
		Arguments:
			-showChain: Output the coordinates of the fragments used in the chains.
			-overlap xxx: Allow xxx bp overlapping for adjacent fragments in the chaining. [default: 0]
			-distance ddd: The difference of the two gaps (one gap in A, one gap in B)between two fragments should be different less than ddd bases.
		(You can pipe the reformat.pl and ChainNucmer) [default: infinity]
	Output:
		For each scaffold in A, it will output a chain, the line will look like:
	
		scaffold_1832 10938 16309 67.067263 scf620008938944 2 [(1755 6139) (9687 14071)] [(9762 16314) (21823 28375)]
			1			2	   3     4            5         6    ....
		
		1: The scaffold id in A.
		2: The number of bases in the chain.
		3: The non-N length of the scaffold in column 1.
		4: The ratio of 3/4
		5: The scaffold in B where the chain aligned to.
		6: Number of the fragment in the chain
		7...: The fragments in the chain: [(q1 q2) (r1 r2)]. Coordinates of (q1 q2) in A aligned to (r1 r2) in B.

EvaluateContigOrder: (ChainNumcer/EvaluateContigOrder.pl)
	Suppose we align the contigs of assembly A to a reference genome R and another assembly B.
	1. Run the nucmer and show-coords, we get: nucmer_R_A_contig.coords, nucmer_B_A_contig.coords
	2. Run: perl EvaluateContigOrder.pl A.contig.oneline.fa nucmer_R_A_contig.coords, nucmer_B_A_contig.coords 
						[-scafPortion sss | -verbose | -testGap B.oneline.fa | -refPortion rrr | -allowPartial]
			Arguments:
				-scafPortion sss: The retained contigs in a A's scaffold must coverage sss' portion of it. [default: 0]
				-verbose: Output more information, like missing contigs in A, the events among the three assemblies.
				-testGap B.oneline.fa: For the contigs in A aligned to B, test whether the gaps contain N in B.
				-refPorition rrr : The length of the single local alignment between a retained A's contig to R must be at least rrr portion of that contigs length. [default: 0.75]
				-allowPartial: We will pick a subset of contigs in A that they are in the same scaffold/chr in B and R, and filter out other contigs aligned to different scaffold/chr.
			Output:
				For each scaffold in A, it will output a few lines if it has more than one retained contigs.
				
				scaffold_2311 chr8 scf620008933774
				1(2008) 2(3035) 5(2056)
				 I: 1(+) 5(+) 2(+)
				II: 1(+) 5(+) 2(+)
				LCS: 3 7099 5043 5043 7099
				Event: Translocation in the assembly. Amount 2056
				
				The first line means the scaffold in A, chr in R, scaffold in B 
				The second line is the contig id and their lengths in A.
				The third line (I) is the order and the orientation in R.
				The fourth line (II) is the order and the orientation in B.
				The LCS line: 3 is the number of retained contigs. Then the three number is the weighted LCS for A to R, A to B and B to R. 
				The Event line describes what's the difference: "in the assembly" means A is different. "in the reference" means R is different, and "in the other assembly" means B is different.

		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		